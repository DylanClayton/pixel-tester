<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>TikTok Pixel Event Tester</title>
    <!-- TikTok Pixel Code Start -->
    <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
    var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
    ;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
    }(window, document, 'ttq');
    </script>
    <!-- TikTok Pixel Code End -->
    <style>
      body {
        font-family: 'VAG Rounded', sans-serif;
        background-color: #FFFFFF;
        color: #000000;
        margin: 0;
        padding: 20px;
      }

      h1 {
        color: #FF0050;
      }
    
      .button {
        background-color: #FF0050;
        color: #FFFFFF;
        border: none;
        padding: 10px 15px;
        cursor: pointer;
        font-size: 16px;
        border-radius: 4px;
      }

      .button:hover {
        background-color: #D10045;
      }

      .input-field {
        border: 1px solid #FF0050;
        padding: 8px;
        margin-bottom: 10px;
        width: 100%;
      }

      .product-fieldset {
        border: 1px solid #FF0050;
        padding: 10px;
        margin-bottom: 15px;
      }

      .product-legend {
        color: #FF0050;
        font-weight: bold;
      }

      select, input {
        padding: 8px;
        margin-bottom: 5px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }

      fieldset {
        border: 1px solid #FF0050;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 4px;
      }

      legend {
        color: #000000;
        font-weight: bold;
        padding: 0 10px;
      }
    </style>
  </head>
  <body>
    <h1>TikTok Pixel Event Tester</h1>

    <label for="eventType">Event Type:</label>
    <select id="eventType">
      <option value="AddPaymentInfo">AddPaymentInfo</option>
      <option value="AddToCart">AddToCart</option>
      <option value="AddToWishlist">AddToWishlist</option>
      <option value="ClickButton">ClickButton</option>
      <option value="CompletePayment">CompletePayment</option>
      <option value="CompleteRegistration">CompleteRegistration</option>
      <option value="Contact">Contact</option>
      <option value="Download">Download</option>
      <option value="InitiateCheckout">InitiateCheckout</option>
      <option value="PlaceAnOrder">PlaceAnOrder</option>
      <option value="Purchase">Purchase</option>
      <option value="Search">Search</option>
      <option value="Subscribe">Subscribe</option>
      <option value="ViewContent">ViewContent</option>
      <option value="Custom">Custom</option>
    </select><br/><br/>

    <div id="customEventNameContainer" style="display:none;">
      <label for="customEventName">Custom Event Name:</label>
      <input type="text" id="customEventName" placeholder="Enter custom event name" /><br/><br/>
    </div>

    <h3>Event Data</h3>
    <label for="currency">Currency:</label>
    <input type="text" id="currency" placeholder="e.g., USD" /><br/><br/>

    <label for="value">Value:</label>
    <input type="number" id="value" placeholder="e.g., 100" step="0.01" /><br/><br/>

    <label for="content_id">Content ID:</label>
    <input type="text" id="content_id" placeholder="e.g., product-123" /><br/><br/>

    <label for="content_type">Content Type:</label>
    <input type="text" id="content_type" placeholder="e.g., product" /><br/><br/>

    <label for="query">Search Query:</label>
    <input type="text" id="query" placeholder="e.g., blue shoes" /><br/><br/>

    <h3>Product Details</h3>
    <div id="productsContainer"></div>
    <button class="button" onclick="addProduct()">Add Product</button><br/><br/>

    <h3>User Data (Optional)</h3>
    <label for="email">Email:</label>
    <input type="email" id="email" placeholder="user@example.com" /><br/><br/>

    <label for="phone">Phone:</label>
    <input type="text" id="phone" placeholder="+1234567890" /><br/><br/>

    <button class="button" onclick="sendEvent()">Send Event</button>

    <script>
      document.getElementById('eventType').addEventListener('change', function() {
        var customEventNameContainer = document.getElementById('customEventNameContainer');
        if (this.value === 'Custom') {
          customEventNameContainer.style.display = 'block';
        } else {
          customEventNameContainer.style.display = 'none';
        }
      });

      function addProduct() {
        const container = document.getElementById('productsContainer');
        const productIndex = container.children.length;
        const productDiv = document.createElement('div');
        productDiv.id = 'product_' + productIndex;
        productDiv.innerHTML = `
          <fieldset>
            <legend>Product ${productIndex + 1}</legend>
            <label>Product ID:</label>
            <input type="text" name="content_id" placeholder="e.g., SKU123" /><br/><br/>
            <label>Product Name:</label>
            <input type="text" name="content_name" placeholder="e.g., Example Product" /><br/><br/>
            <label>Category:</label>
            <input type="text" name="content_category" placeholder="e.g., Electronics" /><br/><br/>
            <label>Brand:</label>
            <input type="text" name="brand" placeholder="e.g., Brand Name" /><br/><br/>
            <label>Quantity:</label>
            <input type="number" name="quantity" placeholder="e.g., 1" /><br/><br/>
            <label>Price:</label>
            <input type="number" name="price" placeholder="e.g., 49.99" step="0.01" /><br/><br/>
            <button type="button" class="button" onclick="removeProduct(${productIndex})">Remove Product</button>
          </fieldset><br/>
        `;
        container.appendChild(productDiv);
      }

      function removeProduct(index) {
        const productDiv = document.getElementById('product_' + index);
        if (productDiv) {
          productDiv.remove();
        }
      }

      function sendEvent() {
        var pixelId = 'D0LKIF3C77U6GBUFJRK0';
        var eventType = document.getElementById('eventType').value;
        var customEventName = document.getElementById('customEventName').value.trim();
        var currency = document.getElementById('currency').value.trim();
        var value = parseFloat(document.getElementById('value').value);
        var content_id = document.getElementById('content_id').value.trim();
        var content_type = document.getElementById('content_type').value.trim();
        var query = document.getElementById('query').value.trim();
        var email = document.getElementById('email').value.trim();
        var phone = document.getElementById('phone').value.trim();

        // Initialize TikTok Pixel with the hardcoded pixel ID
        ttq.load(pixelId);
        ttq.page();

        // Add user data if provided
        if (email || phone) {
          var userData = {};
          if (email) userData.email = email;
          if (phone) userData.phone_number = phone;
          ttq.identify(userData);
        }

        // Build event properties
        var properties = {};
        if (currency) properties.currency = currency;
        if (!isNaN(value)) properties.value = value;
        if (content_id) properties.content_id = content_id;
        if (content_type) properties.content_type = content_type;
        if (query && (eventType === 'Search')) properties.query = query;

        // Gather products data
        var contents = [];
        var container = document.getElementById('productsContainer');
        for (var i = 0; i < container.children.length; i++) {
          var productDiv = container.children[i];
          var product = {};
          var inputs = productDiv.querySelectorAll('input');
          inputs.forEach(function(input) {
            var name = input.name;
            var value = input.value.trim();
            if (value) {
              if (name === 'price' || name === 'quantity') {
                product[name] = parseFloat(value);
              } else {
                product[name] = value;
              }
            }
          });
          if (Object.keys(product).length > 0) {
            contents.push(product);
          }
        }
        if (contents.length > 0) {
          properties.contents = contents;
        }

        // Send event
        if (eventType === 'Custom') {
          if (!customEventName) {
            alert('Please enter a custom event name.');
            return;
          }
          ttq.track(customEventName, properties);
          alert('Event sent: ' + customEventName);
        } else {
          ttq.track(eventType, properties);
          alert('Event sent: ' + eventType);
        }
      }
    </script>
  </body>
</html>
